<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Config.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">handistCollections</a> &gt; <a href="index.source.html" class="el_package">handist.collections.glb</a> &gt; <span class="el_source">Config.java</span></div><h1>Config.java</h1><pre class="source lang-java linenums">/*******************************************************************************
 * Copyright (c) 2021 Handy Tools for Distributed Computing (HanDist) project.
 *
 * This program and the accompanying materials are made available to you under
 * the terms of the Eclipse Public License 1.0 which accompanies this
 * distribution,
 * and is available at https://www.eclipse.org/legal/epl-v10.html
 *
 * SPDX-License-Identifier: EPL-1.0
 ******************************************************************************/
package handist.collections.glb;

import java.io.PrintStream;

import handist.collections.glb.lifeline.Loop;

/**
 * Helper class for the settings that influence the behavior of the Global Load
 * Balancer. All the settings presented here can be set by passing -D arguments
 * to the java command. As an alternative, you could also set them with
 * {@link System#setProperty(String, String)}. In the later case, be aware that
 * parts of the program may have already performed initializations based on the
 * value present before you made the change. Also, make sure that you make your
 * changes consistent across all hosts participating in the computation.
 *
 * @author Patrick Finnerty
 *
 */
<span class="nc" id="L29">public class Config {</span>

    /**
     * Handy enumarator used by the GLB routines to determine which mode should be
     * used to make lifeline answers
     */
<span class="fc" id="L35">    public enum LifelineAnswerMode {</span>
<span class="fc" id="L36">        KRYO, MPI</span>
    }

    /**
     * Option used to activate traces in the GLB
     */
    public static final String ACTIVATE_TRACE = &quot;glb.trace&quot;;

    /**
     * Option used to set the granularity, that is the number of elements workers
     * process before checking the runtime.
     */
    public static final String GRANULARITY = &quot;glb.grain&quot;;

    /**
     * Default value for {@link #GRANULARITY} option.
     */
    public static final int GRANULARITY_DEFAULT = 100;

    /**
     * Option used to set the work-stealing network between the hosts involved in
     * the computation.
     */
    public static final String LIFELINE_STRATEGY = &quot;glb.lifeline&quot;;

    /**
     * Default value for {@link #LIFELINE_STRATEGY}. Is class {@link Loop}.
     */
<span class="fc" id="L64">    public static final String LIFELINE_STRATEGY_DEFAULT = Loop.class.getCanonicalName();</span>

    /**
     * Option used to set the maximum number of concurrent workers used by the load
     * balancer. By default, the value returned by
     * {@link Runtime#availableProcessors()} is used.
     */
    public static final String MAXIMUM_WORKER_COUNT = &quot;glb.workers&quot;;
    /**
     * Determines the technique used to answer lifelines. Options are:
     * &lt;ul&gt;
     * &lt;li&gt;{@value #SERIALIZATION_KRYO} (default option) which uses normal lambda
     * serialization to transmit instances
     * &lt;li&gt;{@value #SERIALIZATION_MPI} which relies on MPI to transmit the byte
     * array into which the object instances have been serialized
     * &lt;/ul&gt;
     */
    public static final String SERIALIZATION = &quot;glb.serialization&quot;;
    /** Option for setting {@link #SERIALIZATION} */
    public static final String SERIALIZATION_MPI = &quot;mpi&quot;;

    /** Option for setting {@link #SERIALIZATION} */
    public static final String SERIALIZATION_KRYO = &quot;kryo&quot;;

    /**
     * Retrieves the granularity to use as defined either by the
     * {@link #GRANULARITY_DEFAULT} property (if set) or by the default value
     * {@value #GRANULARITY_DEFAULT}.
     *
     * @return the granularity to be used by the GLB as an integer
     */
    public static int getGranularity() {
<span class="fc bfc" id="L96" title="All 2 branches covered.">        if (System.getProperties().containsKey(GRANULARITY)) {</span>
<span class="fc" id="L97">            return Integer.parseInt(System.getProperty(GRANULARITY));</span>
        } else {
<span class="fc" id="L99">            return GRANULARITY_DEFAULT;</span>
        }
    }

    /**
     * Returns the lifeline class as defined in the JVM settings
     *
     * @return the fully qualified name of the lifeline class to be used
     */
    public static String getLifelineClassName() {
<span class="fc" id="L109">        return System.getProperty(LIFELINE_STRATEGY, LIFELINE_STRATEGY_DEFAULT);</span>
    }

    /**
     * Indicates which type of lifeline answer should be made
     *
     * @return a value indicating which type of lifeline answer should be made
     */
    public static LifelineAnswerMode getLifelineSerializationMode() {
<span class="fc" id="L118">        final String setting = System.getProperty(SERIALIZATION, SERIALIZATION_KRYO);</span>
<span class="fc bfc" id="L119" title="All 2 branches covered.">        if (SERIALIZATION_MPI.equals(setting)) {</span>
<span class="fc" id="L120">            return LifelineAnswerMode.MPI;</span>
        } else {
<span class="fc" id="L122">            return LifelineAnswerMode.KRYO;</span>
        }
    }

    /**
     * Returns the number of concurrent workers with which the GLB is configured to
     * run. Checks if the {@value #MAXIMUM_WORKER_COUNT} property was set. If so,
     * parses this property. Otherwise, uses the value returned by
     * {@link Runtime#availableProcessors()}.
     *
     * @return the number of concurrent workers with which the GLB can run
     */
    public static int getMaximumConcurrentWorkers() {
<span class="fc bfc" id="L135" title="All 2 branches covered.">        if (System.getProperties().containsKey(MAXIMUM_WORKER_COUNT)) {</span>
<span class="fc" id="L136">            return Integer.parseInt(System.getProperty(MAXIMUM_WORKER_COUNT));</span>
        } else {
<span class="fc" id="L138">            return Runtime.getRuntime().availableProcessors();</span>
        }
    }

    /**
     * Prints the configuration settings set for the GLB which this class handles on
     * the specified output stream
     *
     * @param out the output on which the configuration should be printed to.
     */
    public static void printConfiguration(PrintStream out) {
<span class="nc" id="L149">        out.println(&quot;Concurrent workers; &quot; + getMaximumConcurrentWorkers());</span>
<span class="nc" id="L150">        out.println(&quot;Granulatiry; &quot; + getGranularity());</span>
<span class="nc" id="L151">        out.println(&quot;Lifeline class; &quot; + getLifelineClassName());</span>
<span class="nc" id="L152">        out.println(&quot;Serialization; &quot; + getLifelineSerializationMode());</span>
<span class="nc" id="L153">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>